<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="reports_title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts - Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #17a2b8;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --sidebar-width: 280px;
            
            /* Report Colors */
            --report-blue: linear-gradient(135deg, #3498db, #2980b9);
            --report-green: linear-gradient(135deg, #27ae60, #2ecc71);
            --report-orange: linear-gradient(135deg, #f39c12, #e67e22);
            --report-purple: linear-gradient(135deg, #9b59b6, #8e44ad);
            --report-red: linear-gradient(135deg, #e74c3c, #c0392b);
            --report-teal: linear-gradient(135deg, #1abc9c, #16a085);
        }
        
        /* Language Switcher */
        .language-switcher-header {
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            margin-left: 15px;
        }
        
        body.ltr .language-switcher-header {
            margin-left: 0;
            margin-right: 15px;
        }
        
        .lang-btn {
            padding: 3px 8px;
            border: 2px solid transparent;
            background: transparent;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 11px;
            color: var(--dark-color);
            min-width: 25px;
            text-align: center;
        }
        
        .lang-btn:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateY(-1px);
        }
        
        .lang-btn.active {
            background: var(--report-blue);
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
            border-color: var(--secondary-color);
        }
        
        /* RTL/LTR Support */
        body.ltr {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: ltr;
            text-align: left;
        }
        
        body.ltr .header-title,
        body.ltr .summary-label,
        body.ltr .summary-subtext,
        body.ltr .chart-card-header h5,
        body.ltr .report-tab,
        body.ltr .table-custom th,
        body.ltr .table-custom td,
        body.ltr .stat-label,
        body.ltr .modal-title,
        body.ltr .sidebar-user div,
        body.ltr .nav-link span,
        body.ltr .sidebar-logo h3,
        body.ltr .sidebar-logo small,
        body.ltr .btn-custom {
            text-align: left;
            direction: ltr;
        }
        
        body.ltr .sidebar-nav {
            text-align: left;
        }
        
        body.ltr .nav-link {
            flex-direction: row;
        }
        
        body.ltr .nav-link i {
            margin-right: 0;
            margin-left: 15px;
        }
        
        body.ltr #sidebar {
            right: auto;
            left: 0;
            border-left: none;
            border-right: 4px solid var(--secondary-color);
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
        }
        
        body.ltr .main-content {
            margin-right: 0;
            margin-left: var(--sidebar-width);
        }
        
        body.ltr .main-content.full-width {
            margin-left: 0;
        }
        
        body.ltr .header-title i {
            margin-left: 0;
            margin-right: 10px;
        }
        
        body.ltr .language-switcher-header {
            margin-left: 0;
            margin-right: 15px;
        }
        
        body.ltr .text-end {
            text-align: left !important;
        }
        
        body.ltr .text-start {
            text-align: right !important;
        }
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* ==================== SIDEBAR CORRECTIONS ==================== */
        
        #sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary-color) 0%, #1a252f 100%);
            color: white;
            position: fixed;
            height: 100vh;
            max-height: 100vh;
            padding: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1030;
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary-color);
            right: 0;
            top: 0;
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
        }
        
        #sidebar.hidden {
            transform: translateX(var(--sidebar-width));
        }
        
        body.ltr #sidebar.hidden {
            transform: translateX(calc(-1 * var(--sidebar-width)));
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.2);
        }
        
        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .sidebar-logo i {
            font-size: 2.5rem;
            color: var(--secondary-color);
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .sidebar-user {
            padding: 1rem 1.5rem;
            background: rgba(0,0,0,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-user img {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,0.2);
        }
        
        .sidebar-nav {
            padding: 1rem 0;
            text-align: right;
            flex-grow: 1;
            overflow-y: auto;
            min-height: 0;
        }
        
        body.ltr .sidebar-nav {
            text-align: left;
        }
        
        .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 1rem 1.5rem;
            margin: 0.2rem 0.5rem;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            font-weight: 500;
            white-space: nowrap;
        }
        
        .nav-link:hover {
            color: white;
            background: rgba(255,255,255,0.1);
            transform: translateX(-5px);
        }
        
        body.ltr .nav-link:hover {
            transform: translateX(5px);
        }
        
        .nav-link.active {
            color: white;
            background: var(--secondary-color);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .nav-link i {
            font-size: 1.2rem;
            width: 24px;
        }
        
        .main-content {
            margin-right: var(--sidebar-width);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 100vh;
        }
        
        .main-content.full-width {
            margin-right: 0;
        }
        
        /* ==================== LOGOUT CONTAINER - FIX CRITICAL ==================== */
        
        .logout-container {
            padding: 1rem;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            bottom: 0;
            z-index: 10;
            width: 100%;
            flex-shrink: 0;
        }
        
        /* Header Styles */
        .main-header {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 1020;
            border-bottom: 3px solid var(--secondary-color);
        }
        
        .header-title {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.8rem;
            margin: 0;
        }
        
        .header-title i {
            color: var(--secondary-color);
            margin-left: 10px;
        }
        
        /* Summary Cards */
        .summary-card {
            border: none;
            border-radius: 15px;
            padding: 1.5rem;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            height: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
            z-index: 1;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .summary-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
            opacity: 0.9;
        }
        
        .summary-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0.5rem 0;
            position: relative;
            z-index: 2;
        }
        
        .summary-label {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
            margin-bottom: 0.5rem;
        }
        
        .summary-subtext {
            font-size: 0.9rem;
            opacity: 0.8;
            position: relative;
            z-index: 2;
        }
        
        /* Chart Cards */
        .chart-card {
            background: white;
            border: none;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .chart-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        
        .chart-card-header {
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .chart-card-header h5 {
            color: var(--primary-color);
            font-weight: 700;
            margin: 0;
        }
        
        .chart-card-header h5 i {
            color: var(--secondary-color);
            margin-left: 0.5rem;
        }
        
        /* Report Tables */
        .report-table-card {
            background: white;
            border: none;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .report-table-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        
        /* Table Styles */
        .table-container {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .table-custom {
            margin: 0;
            border-collapse: separate;
            border-spacing: 0;
        }
        
        .table-custom thead {
            background: linear-gradient(135deg, var(--primary-color), #34495e);
            color: white;
        }
        
        .table-custom th {
            font-weight: 600;
            padding: 1rem;
            border: none;
            white-space: nowrap;
        }
        
        .table-custom tbody tr {
            transition: all 0.2s ease;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .table-custom tbody tr:hover {
            background-color: rgba(52, 152, 219, 0.05);
            transform: scale(1.002);
        }
        
        .table-custom td {
            padding: 1rem;
            vertical-align: middle;
        }
        
        /* Tab Navigation */
        .report-tabs {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .report-tab {
            padding: 0.75rem 1.5rem;
            background: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .report-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        
        .report-tab.active {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            color: white;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        /* Quick Stats */
        .quick-stats {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem;
            border-right: 1px solid #eee;
        }
        
        .stat-item:last-child {
            border-right: none;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Badge Styles */
        .badge-custom {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            border: none;
        }
        
        .badge-success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .badge-warning {
            background: linear-gradient(135deg, #f39c12, #f1c40f);
            color: white;
        }
        
        .badge-danger {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
            color: white;
        }
        
        .badge-info {
            background: linear-gradient(135deg, #2980b9, #3498db);
            color: white;
        }
        
        .badge-primary {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            color: white;
        }
        
        /* Button Styles */
        .btn-custom {
            padding: 0.6rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        /* Alert Styles */
        .alert-custom {
            border: none;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Animation */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        /* Responsive - Logique corrigÃ©e */
        @media (max-width: 992px) {
            #sidebar {
                transform: translateX(var(--sidebar-width));
            }
            
            #sidebar.hidden {
                transform: translateX(0) !important;
            }
            
            body.ltr #sidebar {
                transform: translateX(calc(-1 * var(--sidebar-width)));
            }
            
            body.ltr #sidebar.hidden {
                transform: translateX(0) !important;
            }
            
            .main-content {
                margin-right: 0 !important;
                margin-left: 0 !important;
            }
            
            .report-tabs {
                flex-direction: column;
            }
            
            .language-switcher-header {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .header-title {
                font-size: 1.4rem;
            }
            
            .summary-number {
                font-size: 2rem;
            }
            
            .btn-custom {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
            
            .stat-item {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
            
            .stat-item:last-child {
                border-bottom: none;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div id="sidebar" class="d-flex flex-column flex-nowrap">
        <!-- Sidebar Header -->
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-warehouse"></i>
                <div>
                    <h3 class="mb-0 fw-bold" data-i18n="system_name">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø®Ø§Ø²Ù†</h3>
                    <small class="text-white-50" data-i18n="system_integration">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</small>
                </div>
            </div>
        </div>
        
        <!-- User Info -->
        <div class="sidebar-user d-flex align-items-center gap-3">
            <img src="https://ui-avatars.com/api/?name=%D8%A3%D8%AD%D9%85%D8%AF+%D9%85%D8%AD%D9%85%D9%88%D8%AF&background=3498db&color=fff&size=50&rounded=true" 
                 class="rounded-circle" alt="User">
            <div>
                <h6 class="mb-0 fw-bold">Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯</h6>
                <small class="text-white-50" data-i18n="user_role">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</small>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="sidebar-nav flex-grow-1">
            <a href="dashboard.html" class="nav-link">
                <i class="fas fa-chart-line"></i>
                <span data-i18n="dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            </a>
            <a href="inventory.html" class="nav-link">
                <i class="fas fa-boxes"></i>
                <span data-i18n="inventory_management">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
            </a>
            <a href="transactions.html" class="nav-link">
                <i class="fas fa-exchange-alt"></i>
                <span data-i18n="daily_operations">Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</span>
            </a>
            <a href="reports.html" class="nav-link active">
                <i class="fas fa-chart-bar"></i>
                <span data-i18n="reports_analysis">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„</span>
            </a>
            <a href="warehouses.html" class="nav-link">
                <i class="fas fa-warehouse"></i>
                <span data-i18n="warehouse_management">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø²Ù†</span>
            </a>
            <a href="users.html" class="nav-link">
                <i class="fas fa-users"></i>
                <span data-i18n="users">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</span>
            </a>
            <a href="settings.html" class="nav-link">
                <i class="fas fa-cog"></i>
                <span data-i18n="settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
            </a>
        </nav>
        
        <!-- Logout Button - CORRECTED -->
        <div class="logout-container">
            <a href="index.html" class="btn btn-danger w-100 py-2 fw-bold d-flex align-items-center justify-content-center gap-2">
                <i class="fas fa-sign-out-alt"></i>
                <span data-i18n="logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="main-header d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center gap-3">
                <button id="sidebarToggle" class="btn btn-outline-primary d-lg-none">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="header-title">
                    <i class="fas fa-chart-bar"></i>
                    <span data-i18n="reports_title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</span>
                </h1>
            </div>
            
            <div class="d-flex align-items-center gap-3">
                <!-- Language Switcher -->
                <div class="language-switcher-header d-none d-lg-flex">
                    <button class="lang-btn" data-lang="fr">FR</button>
                    <button class="lang-btn active" data-lang="ar">AR</button>
                    <button class="lang-btn" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="ru">RU</button>
                </div>
                
                <!-- Date Filter -->
                <div class="d-flex align-items-center gap-2">
                    <select id="periodFilter" class="form-select form-select-sm w-auto">
                        <option value="7" data-i18n="last_7_days">Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…</option>
                        <option value="30" selected data-i18n="last_30_days">Ø¢Ø®Ø± 30 ÙŠÙˆÙ…</option>
                        <option value="90" data-i18n="last_90_days">Ø¢Ø®Ø± 90 ÙŠÙˆÙ…</option>
                        <option value="365" data-i18n="last_year">Ø¢Ø®Ø± Ø³Ù†Ø©</option>
                    </select>
                    <select id="warehouseFilter" class="form-select form-select-sm w-auto">
                        <option value="" data-i18n="all_warehouses">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ø²Ù†</option>
                        <option value="1" data-i18n="main_warehouse">Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</option>
                        <option value="2" data-i18n="branch_1">Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="3" data-i18n="branch_2">Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                    </select>
                </div>
                
                <!-- Export Buttons -->
                <div class="btn-group">
                    <button id="exportPDF" class="btn btn-danger btn-custom">
                        <i class="fas fa-file-pdf"></i>
                        <span data-i18n="export_pdf">PDF</span>
                    </button>
                    <button id="exportExcel" class="btn btn-success btn-custom">
                        <i class="fas fa-file-excel"></i>
                        <span data-i18n="export_excel">Excel</span>
                    </button>
                </div>
                
                <!-- Print Button -->
                <button id="printReport" class="btn btn-primary btn-custom">
                    <i class="fas fa-print"></i>
                    <span data-i18n="print">Ø·Ø¨Ø§Ø¹Ø©</span>
                </button>
            </div>
        </header>

        <!-- Alert Container -->
        <div id="alertContainer" class="container mt-3"></div>

        <!-- Main Content -->
        <main class="container-fluid py-4">
            <!-- Summary Cards -->
            <div class="row g-4 mb-4 fade-in">
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="summary-card" style="background: var(--report-blue);">
                        <div class="summary-icon">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <h3 class="summary-label" data-i18n="total_products_label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
                        <div class="summary-number" id="totalProducts">1,250</div>
                        <div class="summary-subtext" data-i18n="products_in_stock">Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</div>
                    </div>
                </div>
                
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="summary-card" style="background: var(--report-green);">
                        <div class="summary-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3 class="summary-label" data-i18n="total_transactions_label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</h3>
                        <div class="summary-number" id="totalTransactions">542</div>
                        <div class="summary-subtext" data-i18n="incoming_outgoing">ÙˆØ§Ø±Ø¯ ÙˆØµØ§Ø¯Ø±</div>
                    </div>
                </div>
                
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="summary-card" style="background: var(--report-orange);">
                        <div class="summary-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <h3 class="summary-label" data-i18n="inventory_value_label">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
                        <div class="summary-number" id="totalValue">2.45M</div>
                        <div class="summary-subtext" data-i18n="total_value">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
                    </div>
                </div>
                
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="summary-card" style="background: var(--report-purple);">
                        <div class="summary-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3 class="summary-label" data-i18n="low_stock_label">Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
                        <div class="summary-number" id="lowStockCount">18</div>
                        <div class="summary-subtext" data-i18n="needs_reorder">ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø§Ø¯Ø© Ø·Ù„Ø¨</div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="row g-4 mb-4 fade-in">
                <div class="col-12 col-lg-6">
                    <div class="chart-card">
                        <div class="chart-card-header d-flex justify-content-between align-items-center">
                            <h5>
                                <i class="fas fa-chart-area text-primary"></i>
                                <span data-i18n="stock_value_by_product">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†ØªØ¬</span>
                            </h5>
                            <button id="fullscreenStock" class="btn btn-link text-decoration-none p-0">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                        <div style="height: 300px;">
                            <canvas id="stockValueChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="col-12 col-lg-6">
                    <div class="chart-card">
                        <div class="chart-card-header d-flex justify-content-between align-items-center">
                            <h5>
                                <i class="fas fa-chart-line text-success"></i>
                                <span data-i18n="monthly_transactions">Ø­Ø±ÙƒØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</span>
                            </h5>
                            <select id="chartTypeSelect" class="form-select form-select-sm w-auto">
                                <option value="line" data-i18n="line_chart">Ø®Ø·ÙŠ</option>
                                <option value="bar" data-i18n="bar_chart">Ø£Ø¹Ù…Ø¯Ø©</option>
                            </select>
                        </div>
                        <div style="height: 300px;">
                            <canvas id="monthlyTransChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="col-12">
                    <div class="chart-card">
                        <div class="chart-card-header d-flex justify-content-between align-items-center">
                            <h5>
                                <i class="fas fa-chart-pie text-warning"></i>
                                <span data-i18n="transaction_type_distribution">ØªÙˆØ²ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</span>
                            </h5>
                            <button id="showTransDetails" class="btn btn-link text-decoration-none p-0">
                                <i class="fas fa-list me-1"></i>
                                <span data-i18n="view_details">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</span>
                            </button>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div style="height: 350px;">
                                    <canvas id="transTypeChart"></canvas>
                                </div>
                            </div>
                            <div class="col-lg-6 d-flex align-items-center">
                                <div id="transTypeLegend" class="w-100"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Tabs -->
            <div class="row mb-4 fade-in">
                <div class="col-12">
                    <div class="report-tabs" id="reportTabs">
                        <button class="report-tab active" data-report="stock">
                            <i class="fas fa-boxes"></i>
                            <span data-i18n="inventory_report">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                        </button>
                        <button class="report-tab" data-report="transactions">
                            <i class="fas fa-exchange-alt"></i>
                            <span data-i18n="movement_report">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ©</span>
                        </button>
                        <button class="report-tab" data-report="lowStock">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span data-i18n="low_stock_report">Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span>
                        </button>
                        <button class="report-tab" data-report="expiring">
                            <i class="fas fa-calendar-times"></i>
                            <span data-i18n="expiring_report">Ù‚Ø±ÙŠØ¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</span>
                        </button>
                        <button class="report-tab" data-report="topProducts">
                            <i class="fas fa-star"></i>
                            <span data-i18n="top_products">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                        </button>
                        <button class="report-tab" data-report="warehouse">
                            <i class="fas fa-warehouse"></i>
                            <span data-i18n="warehouse_report">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø§Ø²Ù†</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Report Tables -->
            <div class="row fade-in">
                <div class="col-12">
                    <div id="reportTables" class="report-table-card">
                        <!-- Tables will be loaded here -->
                        <div class="text-center py-5">
                            <div class="loading-spinner mx-auto mb-3"></div>
                            <p class="text-muted mb-0" data-i18n="loading_data">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="row mt-4 fade-in">
                <div class="col-12">
                    <div class="quick-stats">
                        <h5 class="mb-4 fw-bold text-primary">
                            <i class="fas fa-chart-bar me-2"></i>
                            <span data-i18n="quick_stats">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</span>
                        </h5>
                        <div class="row">
                            <div class="col-6 col-md-3 stat-item">
                                <div class="stat-value text-blue-600" id="avgStockValue">1,950</div>
                                <div class="stat-label" data-i18n="avg_product_value">Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù†ØªØ¬</div>
                            </div>
                            <div class="col-6 col-md-3 stat-item">
                                <div class="stat-value text-green-600" id="totalIn">1,250</div>
                                <div class="stat-label" data-i18n="total_incoming">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØ§Ø±Ø¯</div>
                            </div>
                            <div class="col-6 col-md-3 stat-item">
                                <div class="stat-value text-red-600" id="totalOut">708</div>
                                <div class="stat-label" data-i18n="total_outgoing">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµØ§Ø¯Ø±</div>
                            </div>
                            <div class="col-6 col-md-3 stat-item">
                                <div class="stat-value text-orange-600" id="avgTurnover">56%</div>
                                <div class="stat-label" data-i18n="avg_inventory_turnover">Ù…ØªÙˆØ³Ø· Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Fullscreen Modal -->
    <div class="modal fade" id="fullscreenModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fullscreenModalTitle" data-i18n="chart_details">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="fullscreenChartContainer" style="height: 80vh;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script>
        // ğŸŒ LANGUAGE SWITCHER SYSTEM - CORRECTED
        const languageSwitcher = {
            currentLang: 'ar',
            translations: {},
            
            // âœ… COMPLETE Russian translations added
            builtInTranslations: {
                'fr': {
                    "reports_title": "Rapports et Analyse",
                    "system_name": "SystÃ¨me d'EntrepÃ´t",
                    "system_integration": "Gestion IntÃ©grÃ©e",
                    "user_role": "Administrateur SystÃ¨me",
                    "dashboard": "Tableau de Bord",
                    "inventory_management": "Gestion des Stocks",
                    "daily_operations": "OpÃ©rations Quotidiennes",
                    "reports_analysis": "Rapports et Analyse",
                    "warehouse_management": "Gestion des EntrepÃ´ts",
                    "users": "Utilisateurs",
                    "settings": "ParamÃ¨tres",
                    "logout": "DÃ©connexion",
                    "total_products_label": "Total Produits",
                    "products_in_stock": "produits en stock",
                    "total_transactions_label": "Total OpÃ©rations",
                    "incoming_outgoing": "entrÃ©es et sorties",
                    "inventory_value_label": "Valeur du Stock",
                    "total_value": "Valeur Totale",
                    "low_stock_label": "Stock Bas",
                    "needs_reorder": "Besoin de rÃ©approvisionnement",
                    "stock_value_by_product": "Valeur du Stock par Produit",
                    "monthly_transactions": "Mouvements Mensuels",
                    "transaction_type_distribution": "Distribution des Types d'OpÃ©rations",
                    "view_details": "Voir DÃ©tails",
                    "line_chart": "LinÃ©aire",
                    "bar_chart": "Barres",
                    "inventory_report": "Rapport de Stock",
                    "movement_report": "Rapport de Mouvement",
                    "low_stock_report": "Stock Bas",
                    "expiring_report": "Produits Expirant",
                    "top_products": "Meilleurs Produits",
                    "warehouse_report": "Rapport des EntrepÃ´ts",
                    "loading_data": "Chargement des donnÃ©es...",
                    "quick_stats": "Statistiques Rapides",
                    "avg_product_value": "Valeur Moyenne Produit",
                    "total_incoming": "Total EntrÃ©es",
                    "total_outgoing": "Total Sorties",
                    "avg_inventory_turnover": "Rotation Moyenne Stock",
                    "chart_details": "DÃ©tails du Graphique",
                    "export_pdf": "PDF",
                    "export_excel": "Excel",
                    "print": "Imprimer",
                    "last_7_days": "7 derniers jours",
                    "last_30_days": "30 derniers jours",
                    "last_90_days": "90 derniers jours",
                    "last_year": "DerniÃ¨re annÃ©e",
                    "all_warehouses": "Tous les entrepÃ´ts",
                    "main_warehouse": "EntrepÃ´t Principal",
                    "branch_1": "Succursale 1",
                    "branch_2": "Succursale 2",
                    "product": "Produit",
                    "code": "Code",
                    "category": "CatÃ©gorie",
                    "quantity": "QuantitÃ©",
                    "price": "Prix",
                    "value": "Valeur",
                    "status": "Statut",
                    "date": "Date",
                    "type": "Type",
                    "warehouse": "EntrepÃ´t",
                    "user": "Utilisateur",
                    "reference": "RÃ©fÃ©rence",
                    "actions": "Actions",
                    "current_stock": "Stock Actuel",
                    "reorder_level": "Niveau de RÃ©approvisionnement",
                    "difference": "DiffÃ©rence",
                    "last_update": "DerniÃ¨re Mise Ã  Jour",
                    "action": "Action",
                    "percentage": "Pourcentage",
                    "rating": "Ã‰valuation",
                    "available_stock": "Stock Disponible",
                    "total_units": "UnitÃ©s Totales",
                    "total_value_warehouse": "Valeur Totale",
                    "good": "Bon",
                    "low": "Bas",
                    "critical": "Critique",
                    "out_of_stock": "Rupture",
                    "customer": "Client",
                    "no_data": "Pas de donnÃ©es disponibles",
                    "no_low_stock": "Aucun produit en stock bas",
                    "low_stock_count": "Il y a",
                    "products_need_reorder": "produits nÃ©cessitant un rÃ©approvisionnement urgent",
                    "product_ordered": "Produit commandÃ© numÃ©ro",
                    "redirecting_orders": "redirection vers la page des commandes",
                    "order": "Commander",
                    "no_expiring_products": "Aucun produit proche de l'expiration",
                    "exporting": "Exportation",
                    "export_success": "Export rÃ©ussi",
                    "filter_applied": "Filtre appliquÃ©",
                    "selected_warehouse": "EntrepÃ´t sÃ©lectionnÃ©",
                    "incoming_operations": "OpÃ©rations Entrantes",
                    "outgoing_operations": "OpÃ©rations Sortantes",
                    "total": "Total",
                    "unit": "unitÃ©",
                    "operation": "opÃ©ration",
                    "other": "Autre",
                    "incoming": "Entrant",
                    "outgoing": "Sortant",
                    "transfer": "Transfert",
                    "return": "Retour"
                },
                'en': {
                    "reports_title": "Reports and Analysis",
                    "system_name": "Warehouse System",
                    "system_integration": "Integrated Management",
                    "user_role": "System Administrator",
                    "dashboard": "Dashboard",
                    "inventory_management": "Inventory Management",
                    "daily_operations": "Daily Operations",
                    "reports_analysis": "Reports & Analysis",
                    "warehouse_management": "Warehouse Management",
                    "users": "Users",
                    "settings": "Settings",
                    "logout": "Logout",
                    "total_products_label": "Total Products",
                    "products_in_stock": "products in stock",
                    "total_transactions_label": "Total Transactions",
                    "incoming_outgoing": "incoming and outgoing",
                    "inventory_value_label": "Inventory Value",
                    "total_value": "Total Value",
                    "low_stock_label": "Low Stock",
                    "needs_reorder": "Needs reordering",
                    "stock_value_by_product": "Stock Value by Product",
                    "monthly_transactions": "Monthly Transactions",
                    "transaction_type_distribution": "Transaction Type Distribution",
                    "view_details": "View Details",
                    "line_chart": "Line",
                    "bar_chart": "Bar",
                    "inventory_report": "Inventory Report",
                    "movement_report": "Movement Report",
                    "low_stock_report": "Low Stock Report",
                    "expiring_report": "Expiring Products",
                    "top_products": "Top Products",
                    "warehouse_report": "Warehouse Report",
                    "loading_data": "Loading data...",
                    "quick_stats": "Quick Statistics",
                    "avg_product_value": "Average Product Value",
                    "total_incoming": "Total Incoming",
                    "total_outgoing": "Total Outgoing",
                    "avg_inventory_turnover": "Average Inventory Turnover",
                    "chart_details": "Chart Details",
                    "export_pdf": "PDF",
                    "export_excel": "Excel",
                    "print": "Print",
                    "last_7_days": "Last 7 days",
                    "last_30_days": "Last 30 days",
                    "last_90_days": "Last 90 days",
                    "last_year": "Last year",
                    "all_warehouses": "All warehouses",
                    "main_warehouse": "Main Warehouse",
                    "branch_1": "Branch 1",
                    "branch_2": "Branch 2",
                    "product": "Product",
                    "code": "Code",
                    "category": "Category",
                    "quantity": "Quantity",
                    "price": "Price",
                    "value": "Value",
                    "status": "Status",
                    "date": "Date",
                    "type": "Type",
                    "warehouse": "Warehouse",
                    "user": "User",
                    "reference": "Reference",
                    "actions": "Actions",
                    "current_stock": "Current Stock",
                    "reorder_level": "Reorder Level",
                    "difference": "Difference",
                    "last_update": "Last Update",
                    "action": "Action",
                    "percentage": "Percentage",
                    "rating": "Rating",
                    "available_stock": "Available Stock",
                    "total_units": "Total Units",
                    "total_value_warehouse": "Total Value",
                    "good": "Good",
                    "low": "Low",
                    "critical": "Critical",
                    "out_of_stock": "Out of Stock",
                    "customer": "Customer",
                    "no_data": "No data available",
                    "no_low_stock": "No low stock products",
                    "low_stock_count": "There are",
                    "products_need_reorder": "products needing urgent reorder",
                    "product_ordered": "Product ordered number",
                    "redirecting_orders": "redirecting to orders page",
                    "order": "Order",
                    "no_expiring_products": "No expiring products currently",
                    "exporting": "Exporting",
                    "export_success": "Export successful",
                    "filter_applied": "Filter applied",
                    "selected_warehouse": "Selected warehouse",
                    "incoming_operations": "Incoming Operations",
                    "outgoing_operations": "Outgoing Operations",
                    "total": "Total",
                    "unit": "unit",
                    "operation": "operation",
                    "other": "Other",
                    "incoming": "Incoming",
                    "outgoing": "Outgoing",
                    "transfer": "Transfer",
                    "return": "Return"
                },
                // âœ… COMPLETE RUSSIAN TRANSLATIONS ADDED
                'ru': {
                    "reports_title": "ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ¸ ĞĞ½Ğ°Ğ»Ğ¸Ğ·",
                    "system_name": "Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¡ĞºĞ»Ğ°Ğ´Ğ°",
                    "system_integration": "Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ",
                    "user_role": "ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ñ‹",
                    "dashboard": "ĞŸĞ°Ğ½ĞµĞ»ÑŒ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ",
                    "inventory_management": "Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ—Ğ°Ğ¿Ğ°ÑĞ°Ğ¼Ğ¸",
                    "daily_operations": "Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğµ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸",
                    "reports_analysis": "ĞÑ‚Ñ‡ĞµÑ‚Ñ‹ Ğ¸ ĞĞ½Ğ°Ğ»Ğ¸Ğ·",
                    "warehouse_management": "Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¡ĞºĞ»Ğ°Ğ´Ğ°Ğ¼Ğ¸",
                    "users": "ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸",
                    "settings": "ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",
                    "logout": "Ğ’Ñ‹Ğ¹Ñ‚Ğ¸",
                    "total_products_label": "Ğ’ÑĞµĞ³Ğ¾ ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²",
                    "products_in_stock": "Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ½Ğ° ÑĞºĞ»Ğ°Ğ´Ğµ",
                    "total_transactions_label": "Ğ’ÑĞµĞ³Ğ¾ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹",
                    "incoming_outgoing": "Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ¸ Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ",
                    "inventory_value_label": "Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ—Ğ°Ğ¿Ğ°ÑĞ¾Ğ²",
                    "total_value": "ĞĞ±Ñ‰Ğ°Ñ Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ",
                    "low_stock_label": "ĞĞ¸Ğ·ĞºĞ¸Ğ¹ Ğ—Ğ°Ğ¿Ğ°Ñ",
                    "needs_reorder": "Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ",
                    "stock_value_by_product": "Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ—Ğ°Ğ¿Ğ°ÑĞ¾Ğ² Ğ¿Ğ¾ ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñƒ",
                    "monthly_transactions": "Ğ•Ğ¶ĞµĞ¼ĞµÑÑÑ‡Ğ½Ñ‹Ğµ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸",
                    "transaction_type_distribution": "Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¢Ğ¸Ğ¿Ğ¾Ğ² ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹",
                    "view_details": "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸",
                    "line_chart": "Ğ›Ğ¸Ğ½ĞµĞ¹Ğ½Ñ‹Ğ¹",
                    "bar_chart": "Ğ¡Ñ‚Ğ¾Ğ»Ğ±Ñ‡Ğ°Ñ‚Ñ‹Ğ¹",
                    "inventory_report": "ĞÑ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ Ğ—Ğ°Ğ¿Ğ°ÑĞ°Ğ¼",
                    "movement_report": "ĞÑ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ Ğ”Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ",
                    "low_stock_report": "ĞÑ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ ĞĞ¸Ğ·ĞºĞ¾Ğ¼Ñƒ Ğ—Ğ°Ğ¿Ğ°ÑÑƒ",
                    "expiring_report": "Ğ¡Ñ€Ğ¾Ğº Ğ“Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸",
                    "top_products": "Ğ›ÑƒÑ‡ÑˆĞ¸Ğµ ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ñ‹",
                    "warehouse_report": "ĞÑ‚Ñ‡ĞµÑ‚ Ğ¿Ğ¾ Ğ¡ĞºĞ»Ğ°Ğ´Ğ°Ğ¼",
                    "loading_data": "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…...",
                    "quick_stats": "Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°",
                    "avg_product_value": "Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°",
                    "total_incoming": "Ğ’ÑĞµĞ³Ğ¾ Ğ’Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ…",
                    "total_outgoing": "Ğ’ÑĞµĞ³Ğ¾ Ğ˜ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ…",
                    "avg_inventory_turnover": "Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ ĞĞ±Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ Ğ—Ğ°Ğ¿Ğ°ÑĞ¾Ğ²",
                    "chart_details": "Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ°",
                    "export_pdf": "PDF",
                    "export_excel": "Excel",
                    "print": "ĞŸĞµÑ‡Ğ°Ñ‚ÑŒ",
                    "last_7_days": "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 7 Ğ´Ğ½ĞµĞ¹",
                    "last_30_days": "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 30 Ğ´Ğ½ĞµĞ¹",
                    "last_90_days": "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 90 Ğ´Ğ½ĞµĞ¹",
                    "last_year": "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ³Ğ¾Ğ´",
                    "all_warehouses": "Ğ’ÑĞµ ÑĞºĞ»Ğ°Ğ´Ñ‹",
                    "main_warehouse": "Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ğ¡ĞºĞ»Ğ°Ğ´",
                    "branch_1": "Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ» 1",
                    "branch_2": "Ğ¤Ğ¸Ğ»Ğ¸Ğ°Ğ» 2",
                    "product": "ĞŸÑ€Ğ¾Ğ´ÑƒĞºÑ‚",
                    "code": "ĞšĞ¾Ğ´",
                    "category": "ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ",
                    "quantity": "ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾",
                    "price": "Ğ¦ĞµĞ½Ğ°",
                    "value": "Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ",
                    "status": "Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ",
                    "date": "Ğ”Ğ°Ñ‚Ğ°",
                    "type": "Ğ¢Ğ¸Ğ¿",
                    "warehouse": "Ğ¡ĞºĞ»Ğ°Ğ´",
                    "user": "ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ",
                    "reference": "Ğ¡ÑÑ‹Ğ»ĞºĞ°",
                    "actions": "Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ",
                    "current_stock": "Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ—Ğ°Ğ¿Ğ°Ñ",
                    "reorder_level": "Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ—Ğ°ĞºĞ°Ğ·Ğ°",
                    "difference": "Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ°",
                    "last_update": "ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ",
                    "action": "Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ",
                    "percentage": "ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚",
                    "rating": "ĞÑ†ĞµĞ½ĞºĞ°",
                    "available_stock": "Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğ¹ Ğ—Ğ°Ğ¿Ğ°Ñ",
                    "total_units": "Ğ’ÑĞµĞ³Ğ¾ Ğ•Ğ´Ğ¸Ğ½Ğ¸Ñ†",
                    "total_value_warehouse": "ĞĞ±Ñ‰Ğ°Ñ Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ",
                    "good": "Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾",
                    "low": "ĞĞ¸Ğ·ĞºĞ¾",
                    "critical": "ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾",
                    "out_of_stock": "ĞĞµÑ‚ Ğ² Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğ¸",
                    "customer": "ĞšĞ»Ğ¸ĞµĞ½Ñ‚",
                    "no_data": "ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…",
                    "no_low_stock": "ĞĞµÑ‚ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ² Ñ Ğ½Ğ¸Ğ·ĞºĞ¸Ğ¼ Ğ·Ğ°Ğ¿Ğ°ÑĞ¾Ğ¼",
                    "low_stock_count": "Ğ•ÑÑ‚ÑŒ",
                    "products_need_reorder": "Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ², Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‰Ğ¸Ñ… ÑÑ€Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ",
                    "product_ordered": "Ğ—Ğ°ĞºĞ°Ğ·Ğ°Ğ½ Ñ‚Ğ¾Ğ²Ğ°Ñ€ Ğ½Ğ¾Ğ¼ĞµÑ€",
                    "redirecting_orders": "Ğ¿ĞµÑ€ĞµĞ½Ğ°Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñƒ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²",
                    "order": "Ğ—Ğ°ĞºĞ°Ğ·",
                    "no_expiring_products": "ĞĞµÑ‚ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ² Ñ Ğ¸ÑÑ‚ĞµĞºĞ°ÑÑ‰Ğ¸Ğ¼ ÑÑ€Ğ¾ĞºĞ¾Ğ¼ Ğ³Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸",
                    "exporting": "Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚",
                    "export_success": "Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ ÑƒÑĞ¿ĞµÑˆĞµĞ½",
                    "filter_applied": "Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½",
                    "selected_warehouse": "Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ñ‹Ğ¹ ÑĞºĞ»Ğ°Ğ´",
                    "incoming_operations": "Ğ’Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸",
                    "outgoing_operations": "Ğ˜ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸",
                    "total": "Ğ’ÑĞµĞ³Ğ¾",
                    "unit": "ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ğ°",
                    "operation": "Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ",
                    "other": "Ğ”Ñ€ÑƒĞ³Ğ¾Ğµ",
                    "incoming": "Ğ’Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹",
                    "outgoing": "Ğ˜ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹",
                    "transfer": "ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´",
                    "return": "Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚"
                }
            },
            
            // Initialize the language switcher
            init: function() {
                console.log('ğŸŒ Initializing language switcher...');
                this.loadSavedLanguage();
                this.setupEventListeners();
            },
            
            // Load saved language from localStorage or browser
            loadSavedLanguage: function() {
                const savedLang = localStorage.getItem('preferredLang');
                const browserLang = navigator.language.split('-')[0];
                const availableLangs = ['ar', 'fr', 'en', 'ru'];
                
                console.log(`ğŸ“ Saved lang: ${savedLang}, Browser lang: ${browserLang}`);
                
                let langToLoad = savedLang || browserLang || 'ar';
                
                // Validate language
                if (!availableLangs.includes(langToLoad)) {
                    console.warn(`âŒ Language ${langToLoad} not available, defaulting to 'ar'`);
                    langToLoad = 'ar';
                }
                
                console.log(`âœ… Loading language: ${langToLoad}`);
                this.switchLanguage(langToLoad);
            },
            
            // Switch to a specific language
            switchLanguage: async function(langCode) {
                if (this.currentLang === langCode) {
                    console.log(`âš ï¸ Already on language: ${langCode}`);
                    return;
                }
                
                console.log(`ğŸ”„ Switching to language: ${langCode}`);
                
                try {
                    // Use built-in translations
                    if (this.builtInTranslations[langCode]) {
                        this.translations[langCode] = this.builtInTranslations[langCode];
                        console.log(`âœ… Loaded translations for: ${langCode}`);
                    } else {
                        console.warn(`âŒ No translations for ${langCode}, using Arabic fallback`);
                        langCode = 'ar';
                        this.translations[langCode] = this.builtInTranslations['ar'];
                    }
                    
                    // Update current language
                    this.currentLang = langCode;
                    
                    // Save preference
                    localStorage.setItem('preferredLang', langCode);
                    
                    // Apply translations
                    this.applyTranslations(this.translations[langCode]);
                    
                    // Update UI direction and language
                    this.updatePageDirection(langCode);
                    
                    // Update active button
                    this.updateActiveButton(langCode);
                    
                    // Update page title
                    if (this.translations[langCode].reports_title) {
                        document.title = this.translations[langCode].reports_title;
                    }
                    
                    // Refresh charts
                    this.refreshCharts();
                    
                    // Show notification
                    const langName = this.languages[langCode]?.name || langCode;
                    WMS.showAlert(`âœ… Language changed to: ${langName}`, 'success');
                    
                    console.log(`âœ… Language switch completed: ${langCode}`);
                    
                } catch (error) {
                    console.error('âŒ Failed to switch language:', error);
                    WMS.showAlert('âŒ Error changing language', 'danger');
                }
            },
            
            // Apply translations to all elements
            applyTranslations: function(translationData) {
                console.log('ğŸ“ Applying translations...');
                let count = 0;
                
                // Translate text elements
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (translationData[key]) {
                        element.textContent = translationData[key];
                        count++;
                    } else {
                        console.warn(`âš ï¸ Missing translation key: ${key}`);
                    }
                });
                
                // Translate placeholders
                document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                    const key = element.getAttribute('data-i18n-placeholder');
                    if (translationData[key]) {
                        element.placeholder = translationData[key];
                    }
                });
                
                console.log(`ğŸ“ Applied ${count} translations`);
            },
            
            // Update page direction (RTL/LTR)
            updatePageDirection: function(langCode) {
                const html = document.documentElement;
                const body = document.body;
                
                console.log(`ğŸ”„ Updating page direction for: ${langCode}`);
                
                // Remove existing direction classes
                body.classList.remove('ltr');
                
                // Apply LTR for non-Arabic languages (including Russian)
                if (langCode !== 'ar') {
                    html.dir = 'ltr';
                    html.lang = langCode;
                    body.classList.add('ltr');
                    console.log(`âœ… Applied LTR direction for: ${langCode}`);
                } else {
                    html.dir = 'rtl';
                    html.lang = 'ar';
                    console.log(`âœ… Applied RTL direction for Arabic`);
                }
                
                // Force reflow to ensure styles are applied correctly
                document.body.offsetHeight;
            },
            
            // Update active language button
            updateActiveButton: function(langCode) {
                document.querySelectorAll('.lang-btn').forEach(button => {
                    button.classList.remove('active');
                    if (button.getAttribute('data-lang') === langCode) {
                        button.classList.add('active');
                    }
                });
            },
            
            // Setup event listeners for language buttons
            setupEventListeners: function() {
                document.querySelectorAll('.lang-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const lang = e.target.getAttribute('data-lang');
                        console.log(`ğŸ–±ï¸ Language button clicked: ${lang}`);
                        if (lang) {
                            this.switchLanguage(lang);
                        }
                    });
                });
            },
            
            // Refresh charts with new language
            refreshCharts: function() {
                if (typeof updateChartTranslations === 'function') {
                    updateChartTranslations(this.currentLang);
                }
                if (typeof updateTransactionLegend === 'function') {
                    updateTransactionLegend();
                }
            },
            
            // Available languages metadata
            languages: {
                'ar': { name: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', native: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' },
                'fr': { name: 'FranÃ§ais', native: 'FranÃ§ais' },
                'en': { name: 'English', native: 'English' },
                'ru': { name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', native: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹' }
            }
        };

        // ğŸ“Š CHART AND WMS SYSTEMS
        const WMS = {
            toggleSidebar: function() {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.querySelector('.main-content');
                if (sidebar) sidebar.classList.toggle('hidden');
                if (mainContent) mainContent.classList.toggle('full-width');
            },
            
            showAlert: function(message, type = 'info', duration = 5000) {
                const alertContainer = document.getElementById('alertContainer');
                if (!alertContainer) return;
                
                const alert = document.createElement('div');
                alert.className = `alert alert-${type} alert-custom fade-in`;
                alert.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'danger' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'} me-2"></i>
                        <div class="flex-grow-1">${message}</div>
                        <button class="btn btn-link text-${type === 'success' ? 'success' : type === 'danger' ? 'danger' : type === 'warning' ? 'warning' : 'info'} p-0" onclick="this.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                alertContainer.appendChild(alert);
                
                if (duration > 0) {
                    setTimeout(() => {
                        if (alert.parentElement) {
                            alert.remove();
                        }
                    }, duration);
                }
            },
            
            formatNumber: function(num) {
                try {
                    return new Intl.NumberFormat('ar-EG').format(num);
                } catch (e) {
                    return num.toString();
                }
            },
            
            formatCurrency: function(num) {
                try {
                    if (num >= 1000000) {
                        return (num / 1000000).toFixed(2) + ' Ù…Ù„ÙŠÙˆÙ†';
                    } else if (num >= 1000) {
                        return (num / 1000).toFixed(1) + ' Ø£Ù„Ù';
                    }
                    return new Intl.NumberFormat('ar-EG', {
                        style: 'currency',
                        currency: 'EGP'
                    }).format(num);
                } catch (e) {
                    return num + ' Ø¬.Ù…';
                }
            }
        };

        // ğŸ“ˆ GLOBAL VARIABLES
        let stockValueChart = null;
        let monthlyTransChart = null;
        let transTypeChart = null;
        let currentReport = 'stock';

        // ğŸš€ INITIALIZATION
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ PAGE INITIALIZATION STARTED');
            
            // Initialize language switcher
            languageSwitcher.init();
            
            // Load reports data
            loadReportsData();
            
            // Initialize charts
            initializeCharts();
            
            // Show default report table
            showReportTable('stock');
            
            // Setup event listeners
            setupEventListeners();
            
            // Show welcome message
            setTimeout(() => {
                WMS.showAlert('âœ… System ready! Click RU to test Russian', 'success');
            }, 1000);
            
            console.log('âœ… PAGE INITIALIZATION COMPLETED');
        });

        function setupEventListeners() {
            // Sidebar toggle
            const sidebarToggle = document.getElementById('sidebarToggle');
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', WMS.toggleSidebar);
            }
            
            // Period filter
            const periodFilter = document.getElementById('periodFilter');
            if (periodFilter) {
                periodFilter.addEventListener('change', updateReports);
            }
            
            // Warehouse filter
            const warehouseFilter = document.getElementById('warehouseFilter');
            if (warehouseFilter) {
                warehouseFilter.addEventListener('change', updateReports);
            }
            
            // Chart type change
            const chartTypeSelect = document.getElementById('chartTypeSelect');
            if (chartTypeSelect) {
                chartTypeSelect.addEventListener('change', changeChartType);
            }
            
            // Report tabs
            const reportTabs = document.getElementById('reportTabs');
            if (reportTabs) {
                reportTabs.addEventListener('click', function(e) {
                    const tab = e.target.closest('.report-tab');
                    if (tab) {
                        const reportType = tab.getAttribute('data-report');
                        if (reportType) {
                            showReportTable(reportType);
                        }
                    }
                });
            }
            
            // Fullscreen button
            const fullscreenStock = document.getElementById('fullscreenStock');
            if (fullscreenStock) {
                fullscreenStock.addEventListener('click', () => toggleFullscreen('stockValueChart'));
            }
            
            // Transaction details
            const showTransDetails = document.getElementById('showTransDetails');
            if (showTransDetails) {
                showTransDetails.addEventListener('click', showTransactionDetails);
            }
        }

        function loadReportsData() {
            console.log('ğŸ“Š Loading reports data...');
            
            try {
                const mockData = {
                    products: [
                        { id: 1, name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', code: 'LPT001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 50, price: 25000, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 10, value: 1250000 },
                        { id: 2, name: 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', code: 'MS001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 200, price: 150, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 50, value: 30000 },
                        { id: 3, name: 'Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­', code: 'KB001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 150, price: 200, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 30, value: 30000 },
                        { id: 4, name: 'Ø´Ø§Ø´Ø© 24 Ø¨ÙˆØµØ©', code: 'MN001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 80, price: 4000, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 20, value: 320000 },
                        { id: 5, name: 'Ø·Ø§Ø¨Ø¹Ø© Ù„ÙŠØ²Ø±', code: 'PR001', category: 'Ø£Ø¬Ù‡Ø²Ø© ÙƒÙ…Ø¨ÙŠÙˆØªØ±', current_stock: 25, price: 5000, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 5, value: 125000 },
                        { id: 6, name: 'ÙˆØ±Ù‚ A4', code: 'PP001', category: 'Ù‚Ø±Ø·Ø§Ø³ÙŠØ©', current_stock: 500, price: 30, unit: 'Ø±Ø²Ù…Ø©', reorder_level: 100, value: 15000 },
                        { id: 7, name: 'ÙƒØ±Ø³ÙŠ Ù…ÙƒØªØ¨', code: 'CH001', category: 'Ø£Ø«Ø§Ø« Ù…ÙƒØªØ¨ÙŠ', current_stock: 40, price: 1500, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 10, value: 60000 },
                        { id: 8, name: 'Ù…ÙƒØªØ¨ Ø®Ø´Ø¨ÙŠ', code: 'TB001', category: 'Ø£Ø«Ø§Ø« Ù…ÙƒØªØ¨ÙŠ', current_stock: 20, price: 2500, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 5, value: 50000 },
                        { id: 9, name: 'Ø³Ù…Ø§Ø¹Ø§Øª Ø±Ø£Ø³', code: 'HP001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 100, price: 300, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 25, value: 30000 },
                        { id: 10, name: 'ÙÙ„Ø§Ø´ USB 64GB', code: 'USB001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 300, price: 120, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 50, value: 36000 }
                    ],
                    transactions: [
                        { id: 1, type: 'ÙˆØ§Ø±Ø¯', product_name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', quantity: 10, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'INV-2023-001', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' },
                        { id: 2, type: 'ØµØ§Ø¯Ø±', product_name: 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', quantity: 5, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'SALE-2023-001', customer: 'Ø´Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' },
                        { id: 3, type: 'ØªØ­ÙˆÙŠÙ„', product_name: 'Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­', quantity: 20, from_warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', to_warehouse_name: 'Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£ÙˆÙ„', reference: 'TRF-2023-001', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' },
                        { id: 4, type: 'Ø¥Ø±Ø¬Ø§Ø¹', product_name: 'Ø´Ø§Ø´Ø© 24 Ø¨ÙˆØµØ©', quantity: 2, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'RET-2023-001', customer: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙˆØ±', return_reason: 'ØªØ§Ù„Ù', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' },
                        { id: 5, type: 'ÙˆØ§Ø±Ø¯', product_name: 'Ø·Ø§Ø¨Ø¹Ø© Ù„ÙŠØ²Ø±', quantity: 15, warehouse_name: 'Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ', reference: 'INV-2023-002', date: '2023-10-14', user_name: 'Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ' },
                        { id: 6, type: 'ØµØ§Ø¯Ø±', product_name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', quantity: 3, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'SALE-2023-002', customer: 'Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ø¹Ø±ÙØ©', price: 25000, date: '2023-10-14', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' }
                    ]
                };
                
                updateSummaryCards({
                    totalProducts: mockData.products.length,
                    totalTransactions: mockData.transactions.length,
                    totalValue: mockData.products.reduce((sum, p) => sum + (p.current_stock * p.price), 0),
                    lowStockCount: mockData.products.filter(p => p.current_stock <= p.reorder_level).length,
                    avgStockValue: 1950,
                    totalIn: mockData.transactions.filter(t => t.type === 'ÙˆØ§Ø±Ø¯').reduce((sum, t) => sum + t.quantity, 0),
                    totalOut: mockData.transactions.filter(t => t.type === 'ØµØ§Ø¯Ø±').reduce((sum, t) => sum + t.quantity, 0),
                    avgTurnover: 56.6
                });
                
                updateQuickStats();
                
                console.log('âœ… Reports data loaded successfully');
                
            } catch (error) {
                console.error('âŒ Error loading reports data:', error);
                WMS.showAlert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', 'danger');
            }
        }

        function updateSummaryCards(data) {
            const totalProducts = document.getElementById('totalProducts');
            const totalTransactions = document.getElementById('totalTransactions');
            const totalValue = document.getElementById('totalValue');
            const lowStockCount = document.getElementById('lowStockCount');
            
            if (totalProducts) totalProducts.textContent = WMS.formatNumber(data.totalProducts);
            if (totalTransactions) totalTransactions.textContent = WMS.formatNumber(data.totalTransactions);
            if (totalValue) totalValue.textContent = WMS.formatCurrency(data.totalValue);
            if (lowStockCount) lowStockCount.textContent = WMS.formatNumber(data.lowStockCount);
        }

        function initializeCharts() {
            console.log('ğŸ“Š Initializing charts...');
            
            // Stock Value Chart
            const stockCtx = document.getElementById('stockValueChart');
            if (stockCtx) {
                const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
                
                stockValueChart = new Chart(stockCtx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', 'Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­', 'Ø´Ø§Ø´Ø© 24 Ø¨ÙˆØµØ©', 'Ø·Ø§Ø¨Ø¹Ø© Ù„ÙŠØ²Ø±', 'ÙˆØ±Ù‚ A4', 'ÙƒØ±Ø³ÙŠ Ù…ÙƒØªØ¨', 'Ù…ÙƒØªØ¨ Ø®Ø´Ø¨ÙŠ'].map(n => n.length > 15 ? n.substring(0, 15) + '...' : n),
                        datasets: [{
                            label: trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©',
                            data: [1250000, 30000, 30000, 320000, 125000, 15000, 60000, 50000],
                            backgroundColor: '#3498db',
                            borderColor: '#2980b9',
                            borderWidth: 1,
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                rtl: languageSwitcher.currentLang === 'ar',
                                labels: {
                                    font: {
                                        family: 'Cairo',
                                        size: 12
                                    },
                                    color: '#374151'
                                }
                            },
                            tooltip: {
                                rtl: languageSwitcher.currentLang === 'ar',
                                callbacks: {
                                    label: function(context) {
                                        return `${languageSwitcher.builtInTranslations[languageSwitcher.currentLang]?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©'}: ${WMS.formatCurrency(context.parsed.y)}`;
                                    }
                                },
                                titleFont: {
                                    family: 'Cairo'
                                },
                                bodyFont: {
                                    family: 'Cairo'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    font: {
                                        family: 'Cairo'
                                    },
                                    callback: function(value) {
                                        return WMS.formatCurrency(value);
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        family: 'Cairo',
                                        size: 11
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            }
                        }
                    }
                });
            }
            
            // Monthly Transactions Chart
            const monthlyCtx = document.getElementById('monthlyTransChart');
            if (monthlyCtx) {
                const days = [];
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    days.push(`${date.getDate()}/${date.getMonth() + 1}`);
                }
                
                const inData = Array(30).fill(0).map(() => Math.floor(Math.random() * 30) + 5);
                const outData = Array(30).fill(0).map(() => Math.floor(Math.random() * 20) + 3);
                const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
                
                monthlyTransChart = new Chart(monthlyCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: days,
                        datasets: [
                            {
                                label: trans?.incoming || 'ÙˆØ§Ø±Ø¯',
                                data: inData,
                                borderColor: '#27ae60',
                                backgroundColor: 'rgba(39, 174, 96, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            },
                            {
                                label: trans?.outgoing || 'ØµØ§Ø¯Ø±',
                                data: outData,
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                rtl: languageSwitcher.currentLang === 'ar',
                                labels: {
                                    font: {
                                        family: 'Cairo',
                                        size: 12
                                    },
                                    color: '#374151'
                                }
                            },
                            tooltip: {
                                rtl: languageSwitcher.currentLang === 'ar',
                                titleFont: {
                                    family: 'Cairo'
                                },
                                bodyFont: {
                                    family: 'Cairo'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    font: {
                                        family: 'Cairo'
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        family: 'Cairo'
                                    }
                                },
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            }
                        }
                    }
                });
            }
            
            // Transaction Type Chart
            const typeCtx = document.getElementById('transTypeChart');
            if (typeCtx) {
                const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
                
                transTypeChart = new Chart(typeCtx.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: [
                            trans?.incoming || 'ÙˆØ§Ø±Ø¯',
                            trans?.outgoing || 'ØµØ§Ø¯Ø±',
                            trans?.transfer || 'ØªØ­ÙˆÙŠÙ„',
                            trans?.return || 'Ø¥Ø±Ø¬Ø§Ø¹',
                            trans?.other || 'Ø£Ø®Ø±Ù‰'
                        ],
                        datasets: [{
                            data: [35, 25, 20, 15, 5],
                            backgroundColor: [
                                '#27ae60',
                                '#e74c3c',
                                '#3498db',
                                '#f39c12',
                                '#9b59b6'
                            ],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                rtl: languageSwitcher.currentLang === 'ar',
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.raw || 0;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = Math.round((value / total) * 100);
                                        return `${label}: ${value} ${languageSwitcher.builtInTranslations[languageSwitcher.currentLang]?.operation || 'Ø¹Ù…Ù„ÙŠØ©'} (${percentage}%)`;
                                    }
                                },
                                titleFont: {
                                    family: 'Cairo'
                                },
                                bodyFont: {
                                    family: 'Cairo'
                                }
                            }
                        },
                        cutout: '60%'
                    }
                });
                
                updateTransactionLegend();
            }
            
            console.log('âœ… Charts initialized');
        }

        // ğŸ”„ Chart translation update
        function updateChartTranslations(lang) {
            console.log(`ğŸ”„ Updating chart translations for: ${lang}`);
            
            if (stockValueChart) {
                const trans = languageSwitcher.builtInTranslations[lang];
                stockValueChart.data.datasets[0].label = trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©';
                stockValueChart.options.plugins.legend.rtl = lang === 'ar';
                stockValueChart.options.plugins.tooltip.rtl = lang === 'ar';
                stockValueChart.update();
            }
            
            if (monthlyTransChart) {
                const trans = languageSwitcher.builtInTranslations[lang];
                monthlyTransChart.data.datasets[0].label = trans?.incoming || 'ÙˆØ§Ø±Ø¯';
                monthlyTransChart.data.datasets[1].label = trans?.outgoing || 'ØµØ§Ø¯Ø±';
                monthlyTransChart.options.plugins.legend.rtl = lang === 'ar';
                monthlyTransChart.options.plugins.tooltip.rtl = lang === 'ar';
                monthlyTransChart.update();
            }
            
            if (transTypeChart) {
                const trans = languageSwitcher.builtInTranslations[lang];
                transTypeChart.data.labels = [
                    trans?.incoming || 'ÙˆØ§Ø±Ø¯',
                    trans?.outgoing || 'ØµØ§Ø¯Ø±',
                    trans?.transfer || 'ØªØ­ÙˆÙŠÙ„',
                    trans?.return || 'Ø¥Ø±Ø¬Ø§Ø¹',
                    trans?.other || 'Ø£Ø®Ø±Ù‰'
                ];
                transTypeChart.options.plugins.tooltip.rtl = lang === 'ar';
                transTypeChart.update();
                updateTransactionLegend();
            }
        }

        function updateTransactionLegend() {
            const legendContainer = document.getElementById('transTypeLegend');
            if (!legendContainer) return;
            
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            const types = [
                { name: trans?.incoming || 'ÙˆØ§Ø±Ø¯', color: '#27ae60', value: 35, count: 189 },
                { name: trans?.outgoing || 'ØµØ§Ø¯Ø±', color: '#e74c3c', value: 25, count: 135 },
                { name: trans?.transfer || 'ØªØ­ÙˆÙŠÙ„', color: '#3498db', value: 20, count: 108 },
                { name: trans?.return || 'Ø¥Ø±Ø¬Ø§Ø¹', color: '#f39c12', value: 15, count: 81 },
                { name: trans?.other || 'Ø£Ø®Ø±Ù‰', color: '#9b59b6', value: 5, count: 27 }
            ];
            
            legendContainer.innerHTML = `
                <div class="card border-0">
                    <div class="card-body">
                        <h6 class="card-title mb-3">${trans?.transaction_type_distribution || 'ØªÙØ§ØµÙŠÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª'}</h6>
                        ${types.map(type => `
                            <div class="d-flex align-items-center mb-3">
                                <div class="rounded-circle me-3" style="width: 20px; height: 20px; background-color: ${type.color};"></div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between">
                                        <span class="fw-bold">${type.name}</span>
                                        <span>${type.value}%</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-success" style="width: ${type.value}%; background-color: ${type.color};"></div>
                                    </div>
                                    <small class="text-muted d-block mt-1">${type.count} ${trans?.operation || 'Ø¹Ù…Ù„ÙŠØ©'}</small>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function updateQuickStats() {
            const avgStockValue = document.getElementById('avgStockValue');
            const totalIn = document.getElementById('totalIn');
            const totalOut = document.getElementById('totalOut');
            const avgTurnover = document.getElementById('avgTurnover');
            
            if (avgStockValue) avgStockValue.textContent = '1,950';
            if (totalIn) totalIn.textContent = '1,250';
            if (totalOut) totalOut.textContent = '708';
            if (avgTurnover) avgTurnover.textContent = '56%';
        }

        function showReportTable(type) {
            currentReport = type;
            console.log(`ğŸ“‹ Showing report table: ${type}`);
            
            // Update active tab
            document.querySelectorAll('.report-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-report') === type) {
                    tab.classList.add('active');
                }
            });
            
            const container = document.getElementById('reportTables');
            if (!container) return;
            
            try {
                let tableHTML = '';
                
                switch(type) {
                    case 'stock':
                        tableHTML = generateStockTable();
                        break;
                    case 'transactions':
                        tableHTML = generateTransactionsTable();
                        break;
                    case 'lowStock':
                        tableHTML = generateLowStockTable();
                        break;
                    case 'expiring':
                        tableHTML = generateExpiringTable();
                        break;
                    case 'topProducts':
                        tableHTML = generateTopProductsTable();
                        break;
                    case 'warehouse':
                        tableHTML = generateWarehouseTable();
                        break;
                }
                
                container.innerHTML = tableHTML;
                
            } catch (error) {
                console.error('âŒ Error generating table:', error);
                container.innerHTML = `
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </div>
                `;
            }
        }

        function generateStockTable() {
            const products = [
                { id: 1, name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', code: 'LPT001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 50, price: 25000, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 10 },
                { id: 2, name: 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', code: 'MS001', category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', current_stock: 200, price: 150, unit: 'Ù‚Ø·Ø¹Ø©', reorder_level: 50 }
            ];
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            if (products.length === 0) {
                return `
                    <div class="text-center py-5">
                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                        <p class="text-muted mb-0">${trans?.no_data || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'}</p>
                    </div>
                `;
            }
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-boxes text-primary me-2"></i>
                        ${trans?.inventory_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ'}
                    </h5>
                    <button onclick="exportTable('stock')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-hover table-custom">
                            <thead>
                                <tr>
                                    <th width="50">#</th>
                                    <th>${trans?.code || 'Ø§Ù„Ø±Ù…Ø²'}</th>
                                    <th>${trans?.product || 'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬'}</th>
                                    <th>${trans?.category || 'Ø§Ù„ÙØ¦Ø©'}</th>
                                    <th>${trans?.quantity || 'Ø§Ù„ÙƒÙ…ÙŠØ©'}</th>
                                    <th>${trans?.price || 'Ø§Ù„Ø³Ø¹Ø±'}</th>
                                    <th>${trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©'}</th>
                                    <th>${trans?.status || 'Ø§Ù„Ø­Ø§Ù„Ø©'}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${products.map((product, index) => {
                                    const value = product.current_stock * product.price;
                                    const isLow = product.current_stock <= product.reorder_level;
                                    const isCritical = product.current_stock <= 5;
                                    let status = trans?.good || 'Ø¬ÙŠØ¯';
                                    let statusClass = 'badge-success';
                                    
                                    if (product.current_stock === 0) {
                                        status = trans?.out_of_stock || 'Ù†ÙØ¯';
                                        statusClass = 'badge-danger';
                                    } else if (isCritical) {
                                        status = trans?.critical || 'Ø­Ø±Ø¬';
                                        statusClass = 'badge-danger';
                                    } else if (isLow) {
                                        status = trans?.low || 'Ù…Ù†Ø®ÙØ¶';
                                        statusClass = 'badge-warning';
                                    }
                                    
                                    return `
                                        <tr>
                                            <td>${index + 1}</td>
                                            <td class="fw-bold">${product.code || 'N/A'}</td>
                                            <td>
                                                <div class="d-flex align-items-center">
                                                    <i class="fas fa-box text-primary me-2"></i>
                                                    <span>${product.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</span>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="badge bg-light text-dark">${product.category || 'Ø¹Ø§Ù…'}</span>
                                            </td>
                                            <td class="fw-bold">${WMS.formatNumber(product.current_stock)}</td>
                                            <td>${WMS.formatCurrency(product.price)}</td>
                                            <td class="fw-bold text-primary">${WMS.formatCurrency(value)}</td>
                                            <td><span class="badge ${statusClass}">${status}</span></td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateTransactionsTable() {
            const transactions = [
                { id: 1, type: 'ÙˆØ§Ø±Ø¯', product_name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', quantity: 10, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'INV-2023-001', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' },
                { id: 2, type: 'ØµØ§Ø¯Ø±', product_name: 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', quantity: 5, warehouse_name: 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', reference: 'SALE-2023-001', customer: 'Ø´Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©', date: '2023-10-15', user_name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯' }
            ];
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            if (transactions.length === 0) {
                return `
                    <div class="text-center py-5">
                        <i class="fas fa-exchange-alt fa-3x text-muted mb-3"></i>
                        <p class="text-muted mb-0">${trans?.no_data || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'}</p>
                    </div>
                `;
            }
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-exchange-alt text-success me-2"></i>
                        ${trans?.movement_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ©'}
                    </h5>
                    <button onclick="exportTable('transactions')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-hover table-custom">
                            <thead>
                                <tr>
                                    <th width="120">${trans?.date || 'Ø§Ù„ØªØ§Ø±ÙŠØ®'}</th>
                                    <th width="100">${trans?.type || 'Ø§Ù„Ù†ÙˆØ¹'}</th>
                                    <th>${trans?.product || 'Ø§Ù„Ù…Ù†ØªØ¬'}</th>
                                    <th width="100">${trans?.quantity || 'Ø§Ù„ÙƒÙ…ÙŠØ©'}</th>
                                    <th width="150">${trans?.warehouse || 'Ø§Ù„Ù…Ø®Ø²Ù†'}</th>
                                    <th width="150">${trans?.user || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'}</th>
                                    <th width="120">${trans?.reference || 'Ø§Ù„Ù…Ø±Ø¬Ø¹'}</th>
                                    <th width="120">${trans?.actions || 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª'}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${transactions.map((transaction, index) => {
                                    const badgeClass = {
                                        'ÙˆØ§Ø±Ø¯': 'badge-success',
                                        'ØµØ§Ø¯Ø±': 'badge-danger',
                                        'ØªØ­ÙˆÙŠÙ„': 'badge-primary',
                                        'Ø¥Ø±Ø¬Ø§Ø¹': 'badge-warning'
                                    }[transaction.type] || 'badge-info';
                                    
                                    const badgeIcon = {
                                        'ÙˆØ§Ø±Ø¯': 'fa-arrow-down',
                                        'ØµØ§Ø¯Ø±': 'fa-arrow-up',
                                        'ØªØ­ÙˆÙŠÙ„': 'fa-exchange-alt',
                                        'Ø¥Ø±Ø¬Ø§Ø¹': 'fa-undo'
                                    }[transaction.type] || 'fa-question';
                                    
                                    return `
                                        <tr>
                                            <td>${transaction.date || '-'}</td>
                                            <td><span class="badge ${badgeClass} badge-custom"><i class="fas ${badgeIcon} me-1"></i>${transaction.type || '-'}</span></td>
                                            <td>${transaction.product_name || '-'}</td>
                                            <td class="fw-bold">${WMS.formatNumber(transaction.quantity || 0)}</td>
                                            <td>${transaction.warehouse_name || '-'}</td>
                                            <td>${transaction.user_name || '-'}</td>
                                            <td class="font-monospace">${transaction.reference || '-'}</td>
                                            <td>
                                                <div class="d-flex gap-2">
                                                    <button onclick="viewTransactionDetails('${transaction.id}')" class="btn btn-sm btn-outline-primary">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button onclick="deleteTransaction('${transaction.id}')" class="btn btn-sm btn-outline-danger">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateLowStockTable() {
            const products = [
                { id: 1, name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', current_stock: 8, reorder_level: 10, unit: 'Ù‚Ø·Ø¹Ø©' },
                { id: 2, name: 'Ø·Ø§Ø¨Ø¹Ø© Ù„ÙŠØ²Ø±', current_stock: 3, reorder_level: 5, unit: 'Ù‚Ø·Ø¹Ø©' }
            ];
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            const lowStockProducts = products.filter(p => p.current_stock <= p.reorder_level);
            
            if (lowStockProducts.length === 0) {
                return `
                    <div class="text-center py-5">
                        <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                        <p class="text-muted mb-0">${trans?.no_low_stock || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†'}</p>
                    </div>
                `;
            }
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                        ${trans?.low_stock_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†'}
                    </h5>
                    <button onclick="exportTable('lowStock')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="alert alert-warning mb-4">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    ${trans?.low_stock_count || 'ÙŠÙˆØ¬Ø¯'} ${lowStockProducts.length} ${trans?.products_need_reorder || 'Ù…Ù†ØªØ¬ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø·Ù„Ø¨ ÙÙˆØ±ÙŠØ©'}
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-hover table-custom">
                            <thead>
                                <tr>
                                    <th width="50">#</th>
                                    <th>${trans?.product || 'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬'}</th>
                                    <th>${trans?.current_stock || 'Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©'}</th>
                                    <th>${trans?.reorder_level || 'Ø­Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨'}</th>
                                    <th>${trans?.difference || 'Ø§Ù„ÙØ±Ù‚'}</th>
                                    <th>${trans?.action || 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡'}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${lowStockProducts.map((product, index) => {
                                    const diff = product.reorder_level - product.current_stock;
                                    
                                    return `
                                        <tr class="${product.current_stock === 0 ? 'table-danger' : 'table-warning'}">
                                            <td>${index + 1}</td>
                                            <td class="fw-bold">${product.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                                            <td class="fw-bold text-warning">${WMS.formatNumber(product.current_stock)}</td>
                                            <td>${WMS.formatNumber(product.reorder_level)}</td>
                                            <td class="fw-bold text-danger">${WMS.formatNumber(diff)}</td>
                                            <td>
                                                <button onclick="orderProduct(${product.id})" class="btn btn-warning btn-sm">
                                                    <i class="fas fa-shopping-cart me-1"></i> ${trans?.order || 'Ø·Ù„Ø¨'}
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateExpiringTable() {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-calendar-times text-danger me-2"></i>
                        ${trans?.expiring_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø±ÙŠØ¨Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©'}
                    </h5>
                    <button onclick="exportTable('expiring')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="text-center py-5">
                    <i class="fas fa-calendar-check fa-3x text-success mb-3"></i>
                    <p class="text-muted mb-0">${trans?.no_expiring_products || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø±ÙŠØ¨Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹'}</p>
                </div>
            `;
        }

        function generateTopProductsTable() {
            const products = [
                { id: 1, name: 'ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù…Ø­Ù…ÙˆÙ„', current_stock: 50, price: 25000 },
                { id: 2, name: 'Ø´Ø§Ø´Ø© 24 Ø¨ÙˆØµØ©', current_stock: 80, price: 4000 }
            ];
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            const topProducts = products.sort((a, b) => (b.current_stock * b.price) - (a.current_stock * a.price)).slice(0, 10);
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-star text-warning me-2"></i>
                        ${trans?.top_products || 'Ø£ÙØ¶Ù„ 10 Ù…Ù†ØªØ¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø©'}
                    </h5>
                    <button onclick="exportTable('topProducts')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-hover table-custom">
                            <thead>
                                <tr>
                                    <th width="50">#</th>
                                    <th>${trans?.product || 'Ø§Ù„Ù…Ù†ØªØ¬'}</th>
                                    <th>${trans?.quantity || 'Ø§Ù„ÙƒÙ…ÙŠØ©'}</th>
                                    <th>${trans?.price || 'Ø§Ù„Ø³Ø¹Ø±'}</th>
                                    <th>${trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©'}</th>
                                    <th>${trans?.percentage || 'Ø§Ù„Ù†Ø³Ø¨Ø©'}</th>
                                    <th>${trans?.rating || 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ…'}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${topProducts.map((product, index) => {
                                    const value = product.current_stock * product.price;
                                    const totalValue = products.reduce((sum, p) => sum + (p.current_stock * p.price), 0);
                                    const percentage = Math.round((value / totalValue) * 100);
                                    
                                    return `
                                        <tr>
                                            <td>
                                                <span class="badge bg-primary rounded-circle">${index + 1}</span>
                                            </td>
                                            <td class="fw-bold">${product.name || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}</td>
                                            <td>${WMS.formatNumber(product.current_stock)}</td>
                                            <td>${WMS.formatCurrency(product.price)}</td>
                                            <td class="fw-bold text-primary">${WMS.formatCurrency(value)}</td>
                                            <td>
                                                <div class="progress" style="height: 10px;">
                                                    <div class="progress-bar bg-success" style="width: ${percentage}%"></div>
                                                </div>
                                                <small class="text-muted">${percentage}%</small>
                                            </td>
                                            <td>
                                                <div class="text-warning">
                                                    ${'â˜…'.repeat(Math.min(5, Math.ceil(percentage / 20)))}
                                                </div>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function generateWarehouseTable() {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            return `
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-warehouse text-info me-2"></i>
                        ${trans?.warehouse_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø§Ø²Ù†'}
                    </h5>
                    <button onclick="exportTable('warehouse')" class="btn btn-success btn-sm">
                        <i class="fas fa-file-excel me-1"></i> ${trans?.export_excel || 'ØªØµØ¯ÙŠØ± Excel'}
                    </button>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h5 class="card-title">${trans?.main_warehouse || 'Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'}</h5>
                                <div class="display-4 fw-bold text-primary mb-3">75%</div>
                                <div class="progress mb-3">
                                    <div class="progress-bar bg-primary" style="width: 75%"></div>
                                </div>
                                <p class="text-muted mb-2">750 / 1000 ${trans?.total_units || 'ÙˆØ­Ø¯Ø©'}</p>
                                <small class="text-muted">${trans?.total_value_warehouse || 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø©'}: 1,850,000 Ø¬.Ù…</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h5 class="card-title">${trans?.branch_1 || 'Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£ÙˆÙ„'}</h5>
                                <div class="display-4 fw-bold text-success mb-3">45%</div>
                                <div class="progress mb-3">
                                    <div class="progress-bar bg-success" style="width: 45%"></div>
                                </div>
                                <p class="text-muted mb-2">225 / 500 ${trans?.total_units || 'ÙˆØ­Ø¯Ø©'}</p>
                                <small class="text-muted">${trans?.total_value_warehouse || 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø©'}: 425,000 Ø¬.Ù…</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body text-center">
                                <h5 class="card-title">${trans?.branch_2 || 'Ù…Ø®Ø²Ù† Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ'}</h5>
                                <div class="display-4 fw-bold text-warning mb-3">90%</div>
                                <div class="progress mb-3">
                                    <div class="progress-bar bg-warning" style="width: 90%"></div>
                                </div>
                                <p class="text-muted mb-2">270 / 300 ${trans?.total_units || 'ÙˆØ­Ø¯Ø©'}</p>
                                <small class="text-muted">${trans?.total_value_warehouse || 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø©'}: 175,000 Ø¬.Ù…</small>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ğŸ’¾ EXPORT FUNCTIONS
        function exportToPDF() {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            WMS.showAlert(trans?.exporting || 'Ø¬Ø§Ø±Ù ØªØ­Ø¶ÙŠØ± Ù…Ù„Ù PDF Ù„Ù„ØªÙ†Ø²ÙŠÙ„...', 'info');
            setTimeout(() => {
                WMS.showAlert(trans?.export_success || 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 2000);
        }

        function exportToExcel() {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            WMS.showAlert(trans?.exporting || 'Ø¬Ø§Ø±Ù ØªØ­Ø¶ÙŠØ± Ù…Ù„Ù Excel Ù„Ù„ØªÙ†Ø²ÙŠÙ„...', 'info');
            setTimeout(() => {
                WMS.showAlert(trans?.export_success || 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 2000);
        }

        function exportTable(type) {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            const reportNames = {
                'stock': trans?.inventory_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',
                'transactions': trans?.movement_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ©',
                'lowStock': trans?.low_stock_report || 'ØªÙ‚Ø±ÙŠØ± Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',
                'expiring': trans?.expiring_report || 'ØªÙ‚Ø±ÙŠØ± Ù‚Ø±ÙŠØ¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©',
                'topProducts': trans?.top_products || 'ØªÙ‚Ø±ÙŠØ± Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
                'warehouse': trans?.warehouse_report || 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø§Ø²Ù†'
            };
            
            WMS.showAlert(`${trans?.exporting || 'Ø¬Ø§Ø±Ù ØªØµØ¯ÙŠØ±'} ${reportNames[type] || type}...`, 'info');
            setTimeout(() => {
                WMS.showAlert(trans?.export_success || 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 1500);
        }

        function printReportFunc() {
            window.print();
        }

        function updateReports() {
            const period = document.getElementById('periodFilter')?.value || '30';
            const warehouse = document.getElementById('warehouseFilter')?.value || '';
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            const periodText = {
                '7': trans?.last_7_days || 'Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…',
                '30': trans?.last_30_days || 'Ø¢Ø®Ø± 30 ÙŠÙˆÙ…',
                '90': trans?.last_90_days || 'Ø¢Ø®Ø± 90 ÙŠÙˆÙ…',
                '365': trans?.last_year || 'Ø¢Ø®Ø± Ø³Ù†Ø©'
            }[period] || period;
            
            const warehouseText = warehouse ? 
                (trans?.selected_warehouse || 'Ù…Ø®Ø²Ù† Ù…Ø­Ø¯Ø¯') : 
                (trans?.all_warehouses || 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ø²Ù†');
            
            WMS.showAlert(`${trans?.filter_applied || 'ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ±Ø©'}: ${periodText}, ${warehouseText}`, 'info');
            
            showReportTable(currentReport);
        }

        function changeChartType() {
            const type = document.getElementById('chartTypeSelect')?.value || 'line';
            if (monthlyTransChart) {
                monthlyTransChart.config.type = type;
                monthlyTransChart.update();
            }
        }

        function toggleFullscreen(chartId) {
            const modalElement = document.getElementById('fullscreenModal');
            if (!modalElement) return;
            
            const modal = new bootstrap.Modal(modalElement);
            const title = document.getElementById('fullscreenModalTitle');
            const container = document.getElementById('fullscreenChartContainer');
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            if (chartId === 'stockValueChart') {
                if (title) title.textContent = trans?.stock_value_by_product || 'Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†ØªØ¬';
                if (container) {
                    container.innerHTML = '<canvas id="fullscreenStockChart" style="width: 100%; height: 100%;"></canvas>';
                    
                    setTimeout(() => {
                        const canvas = document.getElementById('fullscreenStockChart');
                        if (canvas && stockValueChart) {
                            new Chart(canvas.getContext('2d'), stockValueChart.config);
                        }
                    }, 100);
                }
            }
            
            modal.show();
        }

        function showTransactionDetails() {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            
            const details = `
                <h6 class="mb-3">${trans?.transaction_type_distribution || 'ØªÙØ§ØµÙŠÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª'}</h6>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title text-success">${trans?.incoming_operations || 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø©'}</h5>
                                <p class="card-text">
                                    <i class="fas fa-arrow-down me-2"></i>
                                    ${trans?.total || 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ'}: 189 ${trans?.operation || 'Ø¹Ù…Ù„ÙŠØ©'}
                                </p>
                                <p class="card-text">
                                    <i class="fas fa-box me-2"></i>
                                    ${trans?.quantity || 'Ø§Ù„ÙƒÙ…ÙŠØ©'}: 1,250 ${trans?.unit || 'ÙˆØ­Ø¯Ø©'}
                                </p>
                                <p class="card-text">
                                    <i class="fas fa-money-bill me-2"></i>
                                    ${trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©'}: 850,000 Ø¬.Ù…
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title text-danger">${trans?.outgoing_operations || 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØµØ§Ø¯Ø±Ø©'}</h5>
                                <p class="card-text">
                                    <i class="fas fa-arrow-up me-2"></i>
                                    ${trans?.total || 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ'}: 135 ${trans?.operation || 'Ø¹Ù…Ù„ÙŠØ©'}
                                </p>
                                <p class="card-text">
                                    <i class="fas fa-box me-2"></i>
                                    ${trans?.quantity || 'Ø§Ù„ÙƒÙ…ÙŠØ©'}: 708 ${trans?.unit || 'ÙˆØ­Ø¯Ø©'}
                                </p>
                                <p class="card-text">
                                    <i class="fas fa-money-bill me-2"></i>
                                    ${trans?.value || 'Ø§Ù„Ù‚ÙŠÙ…Ø©'}: 650,000 Ø¬.Ù…
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            WMS.showAlert(details, 'info', 10000);
        }

        function orderProduct(productId) {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            WMS.showAlert(`${trans?.product_ordered || 'ØªÙ… Ø·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬ Ø±Ù‚Ù…'} ${productId}, ${trans?.redirecting_orders || 'Ø³ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª'}`, 'success');
        }

        function viewTransactionDetails(transactionId) {
            WMS.showAlert(`Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø±Ù‚Ù…: ${transactionId}`, 'info');
        }

        function deleteTransaction(transactionId) {
            const trans = languageSwitcher.builtInTranslations[languageSwitcher.currentLang];
            if (confirm(trans?.confirm_delete || 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ')) {
                WMS.showAlert(trans?.operation_deleted || 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                setTimeout(() => {
                    showReportTable(currentReport);
                }, 500);
            }
        }
        
        // ğŸŒ GLOBAL EXPORT
        window.toggleSidebar = WMS.toggleSidebar;
        window.languageSwitcher = languageSwitcher;
    </script>
</body>
</html>